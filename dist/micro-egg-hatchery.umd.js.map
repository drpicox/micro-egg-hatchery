{"version":3,"file":"micro-egg-hatchery.umd.js","sources":["../src/index.js"],"sourcesContent":["const makeBreedEgg = require('./makeBreedEgg')\n\nfunction hatchEgg(egg, tools, hatchedEggs) {\n  if (hatchedEggs.has(egg)) return\n  egg(tools)\n  hatchedEggs.add(egg)\n}\n\nfunction hatchEggs(eggs, tools, hatchedEggs) {\n  for (let i = 0; i < eggs.length; i++)\n    if (Array.isArray(eggs[i])) hatchEggs(eggs[i], tools, hatchedEggs)\n    else hatchEgg(eggs[i], tools, hatchedEggs)\n}\n\nexport default function hatch(...eggs) {\n  let isHatched = false\n  const hatchedEggs = new Set()\n  const checkNoHatched = () => {\n    if (isHatched) throw new Error('cannot use tools once the egg is hatched')\n  }\n\n  const tools = {\n    tool(name, value) {\n      checkNoHatched()\n      tools[name] =\n        typeof value === 'function'\n          ? (...args) => {\n              checkNoHatched()\n              value(...args)\n            }\n          : value\n    },\n    isHatched() {\n      return isHatched\n    },\n  }\n\n  const [breedEgg, getBreed] = makeBreedEgg()\n\n  hatchEgg(breedEgg, tools, hatchedEggs)\n  hatchEggs(eggs, tools, hatchedEggs)\n  isHatched = true\n  delete tools.tool\n\n  return getBreed()\n}\n"],"names":["makeBreedEgg","require","hatchEgg","egg","tools","hatchedEggs","has","add","hatchEggs","eggs","i","length","Array","isArray","hatch","isHatched","Set","checkNoHatched","Error","tool","name","value","breedEgg","getBreed"],"mappings":";;;;;;EAAA,IAAMA,YAAY,GAAGC,OAAO,CAAC,gBAAD,CAA5B;;EAEA,SAASC,QAAT,CAAkBC,GAAlB,EAAuBC,KAAvB,EAA8BC,WAA9B,EAA2C;EACzC,MAAIA,WAAW,CAACC,GAAZ,CAAgBH,GAAhB,CAAJ,EAA0B;EAC1BA,EAAAA,GAAG,CAACC,KAAD,CAAH;EACAC,EAAAA,WAAW,CAACE,GAAZ,CAAgBJ,GAAhB;EACD;;EAED,SAASK,SAAT,CAAmBC,IAAnB,EAAyBL,KAAzB,EAAgCC,WAAhC,EAA6C;EAC3C,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,IAAI,CAACE,MAAzB,EAAiCD,CAAC,EAAlC;EACE,QAAIE,KAAK,CAACC,OAAN,CAAcJ,IAAI,CAACC,CAAD,CAAlB,CAAJ,EAA4BF,SAAS,CAACC,IAAI,CAACC,CAAD,CAAL,EAAUN,KAAV,EAAiBC,WAAjB,CAAT,CAA5B,KACKH,QAAQ,CAACO,IAAI,CAACC,CAAD,CAAL,EAAUN,KAAV,EAAiBC,WAAjB,CAAR;EAFP;EAGD;;EAEc,SAASS,KAAT,GAAwB;EACrC,MAAIC,UAAS,GAAG,KAAhB;EACA,MAAMV,WAAW,GAAG,IAAIW,GAAJ,EAApB;;EACA,MAAMC,cAAc,GAAG,YAAM;EAC3B,QAAIF,UAAJ,EAAe,MAAM,IAAIG,KAAJ,CAAU,0CAAV,CAAN;EAChB,GAFD;;EAIA,MAAMd,KAAK,GAAG;EACZe,IAAAA,IADY,gBACPC,IADO,EACDC,KADC,EACM;EAChBJ,MAAAA,cAAc;EACdb,MAAAA,KAAK,CAACgB,IAAD,CAAL,GACE,OAAOC,KAAP,KAAiB,UAAjB,GACI,YAAa;EACXJ,QAAAA,cAAc;EACdI,QAAAA,KAAK,MAAL;EACD,OAJL,GAKIA,KANN;EAOD,KAVW;EAWZN,IAAAA,SAXY,uBAWA;EACV,aAAOA,UAAP;EACD;EAbW,GAAd;;EAPqC,sBAuBRf,YAAY,EAvBJ;EAAA,MAuB9BsB,QAvB8B;EAAA,MAuBpBC,QAvBoB;;EAyBrCrB,EAAAA,QAAQ,CAACoB,QAAD,EAAWlB,KAAX,EAAkBC,WAAlB,CAAR;;EAzBqC,oCAANI,IAAM;EAANA,IAAAA,IAAM;EAAA;;EA0BrCD,EAAAA,SAAS,CAACC,IAAD,EAAOL,KAAP,EAAcC,WAAd,CAAT;EACAU,EAAAA,UAAS,GAAG,IAAZ;EACA,SAAOX,KAAK,CAACe,IAAb;EAEA,SAAOI,QAAQ,EAAf;EACD;;;;;;;;"}